!function(n,e,o){"use strict";function t(n){if("string"==typeof n){var c=n.split("/");return c.pop(),o.getJSON(n).then(function(n){return n.baseUrl=c.join("/"),t(n)})}return(n.types||[]).forEach(function(o){e.dependencies[o]=n.dependencies.map(function(n){return i(n)})||[]}),Promise.all([(n.msg||"blockly/msg")+"/"+e.LANG+".js",(n.blocksMsg||"blockly/msg/blocks")+"/"+e.LANG+".js"].concat(n.scripts||["blockly/blocks.js","blockly/javascript.js"]).map(function(n){return e.loadJs(i(n))}).concat(["function"==typeof n.toolbox?new Promise(function(o){n.toolboxXml=n.toolbox(e.rawToolbox),o()}):e.loadDoc(i(n.toolbox||"blockly/toolbox.xml")).then(function(o){n.toolboxXml=e.trimXml(o.body.firstElementChild)})])).then(function(){return n}).catch(function(e){return swal({type:"error",text:"載入自訂積木時發生問題，請檢查檔案是否正確，或者將其移除（"+e+"）",allowOutsideClick:!1}),n});function i(e){var o=e.toLowerCase();return 0!==o.indexOf("//")&&0!==o.indexOf("http://")&&0!==o.indexOf("https://")&&(e=n.baseUrl?n.baseUrl+"/"+e:e),e}}e.dependencies=e.dependencies||{},e.getBlocksDependencies=function(n){return(n||Object.keys(e.dependencies)).map(function(n){return e.dependencies[n]||[]}).reduce(function(n,e){return e.forEach(function(e){-1===n.indexOf(e)&&n.push(e)}),n},[])},e.loadBlockDefs=function(n,e){if("function"!=typeof e)return t(n);t(n).then(function(){e()})}}(window,window.Code,window.jQuery);