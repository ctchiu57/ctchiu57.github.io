!function(a,t){"use strict";var e,n=a.location,o=a.localStorage,r=a.XMLHttpRequest;function s(a){this._root=a,this._ajax=null}function i(e,o,s,i){switch(e._ajax&&e._ajax.abort(),e._ajax=new r,e._ajax.name=o,e._ajax.onreadystatechange=function(t,e){if(4===t._ajax.readyState){if(200!=t._ajax.status)e(new Error(t._ajax.status));else{var o=t._ajax.responseText.trim();"data"===t._ajax.name?(o=JSON.parse(o).name,e(null,(n.protocol+"//"+n.host+n.pathname).split("/")+"#"+o)):"key"===t._ajax.name&&(o.length?(o=JSON.parse(o),e(null,o)):e(new Error("Unmatched Key: "+a.location.hash)))}t._ajax=null}}.bind(t,e,i),o){case"data":e._ajax.open("POST",e._root+".json"),e._ajax.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e._ajax.send(JSON.stringify(s));break;case"key":e._ajax.open("GET",e._root+"/"+s+".json"),e._ajax.send()}}(e=s.prototype).backup=function(a,t){var e=n.href.split("#")[0];o.setItem(e,JSON.stringify(a)),"function"==typeof t&&t(null)},e.restore=function(a){var t=n.href.split("#")[0];"function"==typeof a&&a(null,o[t]?JSON.parse(o[t]):"")},e.link=function(a,t){i(this,"data",a,t)},e.retrieve=function(a,t){i(this,"key",a,t)},a.JSONStorage=s}(window);